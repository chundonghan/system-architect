## 第2章 操作系统
### 2.1 操作系统的类型与结构
操作系统的基本类型有：`批处理操作系统`,`分时操作系统`,`实时操作系统`.  
从`资源管理`的角度看,操作系统主要是对`处理器`,`存储器`,`文件`,`设备`,`作业`进行管理.  
#### 2.1.1 操作系统的定义
操作系统(Operating System, OS)是计算机系统中的核心系统软件,负责管理和控制计算机系统中的硬件和软件资源,合理地组织计算机工作流程和有效地利用资源,在计算机与用户之间起接口的作用.  
- 为用户的接口表现为: 命令,菜单,窗口  
- 为应用程序提供的接口为API  

图2-1 操作系统与硬件/软件的关系  
![操作系统与硬件/软件的关系](https://raw.githubusercontent.com/chundonghan/system-architect/master/img/ch2_1.png)  

#### 2.1.2 操作系统分类
- 批处理操作系统
- 分时操作系统
- 实时操作系统
- 网络操作系统
- 分布式操作系统
- 嵌入式操作系统
- 微内核操作系统

### 2.2 操作系统基本原理
操作系统的主要功能是进行处理机与`进程管理`,`存储管理`,`设备管理`,`文件管理`和`作业管理`的工作.
#### 2.2.1 进程管理
进程是处理机管理中最基本的、最重要的概念。以进程作为独立运行的基本单位，以进程作为分配资源的基本单位。  
- 进程的状态转换  
  + 就绪状态  
  + 执行状态  
  + 阻塞状态  

图2-2 基本状态转换  
![进程的三种基本状态转换](https://raw.githubusercontent.com/chundonghan/system-architect/master/img/ch2_2.png)  
- 挂起状态
引入挂起状态的原因：
  + 对换的需要：缓解内存紧张
  + 终端用户的请求
  + 父进程请求
  + 负荷调节的需要
  + 操作系统的需要

图2-3 具有挂起操作的进程状态的演变情况  
![进程状态转换](https://raw.githubusercontent.com/chundonghan/system-architect/master/img/ch2_3.png)  
- 进程互斥与同步  
  + 互斥：保证临界资源在某一时刻只被一个进程访问。是资源的竞争关系。  
  + 同步：是各进程按一定的制约顺序和速度执行。是进程间的协作关系。  

`临界资源`：一次仅允许一个进程使用的资源。  
`临界区`：一个进程访问临界资源的那段程序代码。  
`进程间的互斥`：禁止两个或两个以上的进程同时进入访问同一临界资源的临界区。  
- 前趋图  
前趋图是一个由节点和有向边构成的有向无循环图。通常用于表现事务之间先后顺序的制约关系。  
指令可分解为`取指`、`分析`、`执行`三步。  
- 进程调度与死锁  
进程调度即处理器调度（上下文转换）。  
进程调度方式：  
  + 剥夺方式  
  + 非剥夺方式 
进程调度算法： 
  + 先来先服务 
  + 优先树调度 
  + 轮转法 （时间片） 

采用`死锁发生后的检测与恢复策略`比采用`死锁发生前的预防与避免策略`代价小一些。  

#### 2.2.2 存储管理
存储器是计算机系统中最重要的资源之一。存储管理直接影响系统性能。  
存储管理主要是指`对内存储器的管理`，负责对内存的分配和回收、内存的保护和内存的扩充。  
存储管理的目的是`尽量提高内存的使用效率`。  
段页式存储管理：  
1. 页式存储管理  
2. 段式存储管理  
3. 段页式存储管理  

#### 2.2.3 设备管理
数据传送控制方式原则：  
1. 数据传送速度足够高，能满足用户的需要但又不丢失数据。  
2. 系统开销小，所需的处理控制程序少。  
3. 能充分发挥硬件资源的能力，使得I/O设备尽量处于使用状态，而CPU等待时间少。  

控制方式：  
1. 程序控制方式  
2. 中断方式  
3. 直接存储访问  
4. 通道方式  
  - 字节多路通道  
  - 选择通道  
  - 成组多路通道  
假脱机（SPOOLING）：外部设备同时联机操作，采用一组程序或进程模拟一台输入/输出处理器。  

#### 2.2.4 文件管理
文件管理的功能：建立、修改、删除文件；按文件名访问文件；决定文件信息的存放位置、存放形式、存取权限；管理文件间的联系及提供对文件的共享、保护和保密等。  
一般文件存取设置两级控制：第一级是访问者的识别，第二级是存取权限的识别。  
1. 文件的逻辑结构  
  文件的结构是指文件的组织形式。从用户角度看到的文件组织形式即为文件的逻辑结构。  
  一般文件的逻辑结构分为两种：无结构的字符流文件和有结构的记录文件。  
  记录文件：
    1. 顺序文件  
    2. 索引顺序文件  
    3. 索引文件  
    4. 直接文件  
2. 文件的物理结构  
文件的物理结构是指文件在存储设备上的存放方法。文件分配策略：  
    1. 顺序分配  
    2. 链接分配
    3. 索引分配  
3. 文件存储设备管理  
文件存储设备的管理实质上是对空闲块的组织和管理问题。  
三种空闲块管理方法：  
    1. 索引法  
    2. 链接法  
    3. 位示图法  
4. 树型目录结构  
#### 2.2.5 作业管理
作业由程序、数据和作业说明书组成。系统通过作业说明书控制文件形式的程序和数据，使之执行和操作。  
